{"version":3,"sources":["components/timeline_slider.jsx"],"names":[],"mappings":"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","file":"timeline_slider.js","sourcesContent":["import React from 'react';\nimport { SVG } from './react_svg';\nimport Background from './background';\nimport XAxis from './x_axis';\nimport PlayStop from './play_stop';\nimport _ from 'underscore';\n\nexport default class TimelineSlider extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      value: null,\n      isPlaying: false\n    };\n  }\n\n  onValueChange(v) {\n    this.setState({ value: v }, () => {\n      this.props.onValueChange(this.value());\n    });\n  }\n\n  rawValue() {\n    if(this.state.value) return this.state.value;\n    if(this.props.defaultValue) return this.props.defaultValue;\n    return this.computeDefaultValue();\n  }\n\n  computeDefaultValue() {\n    if(this.props.multi) {\n      return [\n        Math.min.apply(Math, this.props.range),\n        Math.max.apply(Math, this.props.range)\n      ];\n    } else {\n      return [Math.max.apply(Math, this.props.range)];\n    }\n  }\n\n  value() {\n    let rawValue = this.rawValue();\n    if(this.props.multi) {\n      return rawValue;\n    } else {\n      return rawValue[0];\n    }\n  }\n\n  textSize() {\n    let letterSize = 5;\n    return this.props.range.map((i) => {\n      return i.toString().length;\n    }).reduce((a,b) => a+b) * letterSize;\n  }\n\n  contextSize() {\n    let playStopControlWidth = 0;\n\n    if(this.props.playStop) {\n      playStopControlWidth = 50;\n    }\n\n    if(this.textSize() > ((this.props.width - playStopControlWidth) / 2)) {\n      return \"compact\";\n    } else {\n      return \"large\";\n    }\n  }\n\n  width() {\n    let max = Math.max(this.props.width, this.textSize()/2);\n    if(max) return max;\n    return 0;\n  }\n\n  height() {\n    if(this.contextSize() == \"compact\") {\n      return 65;\n    } else {\n      return 45;\n    }\n  }\n\n  togglePlayStop() {\n    let prevIsPlaying = this.state.isPlaying;\n    let nextIsPlaying = !this.state.isPlaying;\n\n    this.setState({\n      isPlaying: nextIsPlaying\n    });\n\n    if(this.props.onPlayChange) {\n      this.props.onPlayChange(prevIsPlaying, nextIsPlaying);\n    }\n  }\n\n  propsAreEqual(nextProps, props) {\n    return _.compact(props.map((prop) => {\n      return _.isEqual(nextProps[prop], this.props[prop]);\n    })).length == props.length;\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if(!this.propsAreEqual(nextProps, ['range', 'multi', 'defaultValue'])) {\n      this.setState({ value: null });\n    }\n  }\n\n  render() {\n    return (\n      <SVG className=\"react-timeline-slider\"\n        width={this.width()} height={this.height()}>\n        <Background />\n        {(()=>{\n          if(this.props.playStop) {\n            return (\n              <PlayStop\n                contextSize={this.contextSize()}\n                isPlaying={this.state.isPlaying}\n                onToggle={this.togglePlayStop.bind(this)} />\n            );\n          }\n        })()}\n        <XAxis contextSize={this.contextSize()}\n          width={this.width()}\n          range={this.props.range}\n          value={this.rawValue()}\n          multi={this.props.multi}\n          playStop={this.props.playStop}\n          playStopSpeed={this.props.playStopSpeed}\n          isPlaying={this.state.isPlaying}\n          onStop={this.togglePlayStop.bind(this)}\n          onValueChange={this.onValueChange.bind(this)}/>\n      </SVG>\n    );\n  }\n}\n\nTimelineSlider.defaultProps = {\n  styles: {},\n  multi: false,\n  playStop: false\n}\n"]}