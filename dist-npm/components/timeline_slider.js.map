{"version":3,"sources":["components/timeline_slider.jsx"],"names":[],"mappings":"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","file":"timeline_slider.js","sourcesContent":["import React from 'react';\nimport { SVG } from './react_svg';\nimport Background from './background';\nimport XAxis from './x_axis';\nimport PlayStop from './play_stop';\nimport _ from 'underscore';\n\nexport default class TimelineSlider extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      value: null,\n      isPlaying: false\n    };\n  }\n\n  onValueChange(v) {\n    this.setState({ value: v }, () => {\n      this.props.onValueChange(this.value());\n    });\n  }\n\n  rawValue() {\n    if(this.state.value) return this.state.value;\n    if(this.props.defaultValue) return this.props.defaultValue;\n    return this.computeDefaultValue();\n  }\n\n  computeDefaultValue() {\n    if(this.props.multi) {\n      return [\n        Math.min.apply(Math, this.props.range),\n        Math.max.apply(Math, this.props.range)\n      ];\n    } else {\n      return [Math.max.apply(Math, this.props.range)];\n    }\n  }\n\n  value() {\n    let rawValue = this.rawValue();\n    if(this.props.multi) {\n      return rawValue;\n    } else {\n      return rawValue[0];\n    }\n  }\n\n  textSize() {\n    let letterSize = 5;\n    return this.props.range.map((i) => {\n      return i.toString().length;\n    }).reduce((a,b) => a+b) * letterSize;\n  }\n\n  contextSize() {\n    let playStopControlWidth = 0;\n\n    if(this.props.playStop) {\n      playStopControlWidth = 50;\n    }\n\n    if(this.textSize() > ((this.props.width - playStopControlWidth) / 2)) {\n      return \"compact\";\n    } else {\n      return \"large\";\n    }\n  }\n\n  width() {\n    let max = Math.max(this.props.width, this.textSize()/2);\n    if(max) return max;\n    return 0;\n  }\n\n  height() {\n    if(this.contextSize() == \"compact\") {\n      return 65;\n    } else {\n      return 45;\n    }\n  }\n\n  togglePlayStop() {\n    let prevIsPlaying = this.state.isPlaying;\n    let nextIsPlaying = !this.state.isPlaying;\n\n    this.setState({\n      isPlaying: nextIsPlaying\n    });\n\n    if(this.props.onPlayChange) {\n      this.props.onPlayChange(prevIsPlaying, nextIsPlaying);\n    }\n  }\n\n  propsAreEqual(nextProps, props) {\n    return _.compact(props.map((prop) => {\n      return _.isEqual(nextProps[prop], this.props[prop]);\n    })).length == props.length;\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if(!this.propsAreEqual(nextProps, ['range', 'multi', 'defaultValue'])) {\n      this.setState({ value: null });\n    }\n  }\n\n  render() {\n    return (\n      <SVG className=\"react-timeline-slider\"\n        width={this.width()} height={this.height()}>\n        <Background />\n        {(()=>{\n          if(this.props.playStop) {\n            return (\n              <PlayStop\n                contextSize={this.contextSize()}\n                isPlaying={this.state.isPlaying}\n                onToggle={this.togglePlayStop.bind(this)} />\n            );\n          }\n        })()}\n        <XAxis contextSize={this.contextSize()}\n          width={this.width()}\n          range={this.props.range}\n          value={this.rawValue()}\n          multi={this.props.multi}\n          playStop={this.props.playStop}\n          playStopSpeed={this.props.playStopSpeed}\n          isPlaying={this.state.isPlaying}\n          onStop={this.togglePlayStop.bind(this)}\n          onValueChange={this.onValueChange.bind(this)}/>\n      </SVG>\n    );\n  }\n}\n\nTimelineSlider.defaultProps = {\n  styles: {},\n  multi: false,\n  playStop: false\n}\n"]}